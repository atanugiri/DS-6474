---
title: "HW8_Practice"
output: pdf_document
date: "2025-04-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
set.seed(1)
X = rnorm(n = 100)
epsilon = rnorm(n = 100)
```

```{r}
beta = rep(NA, 3)
beta0 = 2; beta[1] = 3; beta[2] = -1.5; beta[3] = -2
Y = beta0 + beta[1]*X + beta[2]*X^2 + beta[3]*X^3 + epsilon
```

```{r}
library(leaps)
data = data.frame(Y=Y, X=X)
lm_fit = regsubsets(Y ~ poly(X, 10, raw=TRUE), data = data, nvmax=10)
lm_fit_summary = summary(lm_fit)
lm_fit_summary
```

```{r}
cp = lm_fit_summary$cp
plot(cp)
# which.min(lm_fit_summary$cp)
points(which.min(cp), cp[which.min(cp)], col="red", pch=19)
```


